<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MintWaterfall TypeScript Demo</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f8f9fa;
        }
        .demo-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .demo-title {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        .demo-subtitle {
            font-size: 16px;
            color: #7f8c8d;
            margin-bottom: 30px;
            text-align: center;
        }
        .chart-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .controls button {
            margin: 0 10px;
            padding: 8px 16px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .controls button:hover {
            background: #2980b9;
        }
        .axis text {
            font-size: 12px;
        }
        .axis line, .axis path {
            stroke: #666;
            shape-rendering: crispEdges;
        }
        .info-panel {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 14px;
            color: #2c3e50;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            color: white;
            background: #27ae60;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-title">ðŸŒŠ MintWaterfall TypeScript Core Demo</div>
        <div class="demo-subtitle">
            Demonstrating the gradual migration to TypeScript - Core module converted 
            <span class="status">âœ“ WORKING</span>
        </div>
        
        <div class="controls">
            <button onclick="toggleStacked()">Toggle Stacked/Waterfall</button>
            <button onclick="toggleTotal()">Toggle Total Bar</button>
            <button onclick="regenerateData()">New Data</button>
        </div>

        <div class="chart-container">
            <svg id="chart" width="800" height="400"></svg>
        </div>

        <div class="info-panel">
            <strong>TypeScript Migration Status:</strong><br>
            âœ… Core chart module converted to TypeScript<br>
            âœ… Type safety for ChartData, ProcessedData, MarginConfig<br>
            âœ… Proper D3 type integration<br>
            âœ… Getter/setter API with type checking<br>
            ðŸ”„ Gradual migration in progress - maintaining JavaScript compatibility
        </div>
    </div>

    <!-- Import the compiled TypeScript module -->
    <script type="module">
        // For demo purposes, we'll use the JavaScript version temporarily
        // until we have the complete TypeScript build pipeline
        
        // Sample data generator
        function generateSampleData() {
            const categories = ['Q1 Sales', 'Q2 Sales', 'Q3 Sales', 'Q4 Sales', 'Marketing', 'R&D'];
            return categories.map(label => ({
                label,
                stacks: [{
                    value: Math.random() * 100 - 20,
                    color: Math.random() > 0.5 ? '#3498db' : '#e74c3c'
                }]
            }));
        }

        // Initialize chart with TypeScript-style configuration
        const chart = d3.waterfallChart()
            .width(760)
            .height(360)
            .margin({top: 40, right: 40, bottom: 60, left: 60})
            .showTotal(true)
            .stacked(false);

        let currentData = generateSampleData();
        
        // Initial render
        d3.select("#chart")
            .datum(currentData)
            .call(chart);

        // Demo controls
        window.toggleStacked = function() {
            const isStacked = chart.stacked();
            chart.stacked(!isStacked);
            d3.select("#chart")
                .datum(currentData)
                .call(chart);
        };

        window.toggleTotal = function() {
            const showTotal = chart.showTotal();
            chart.showTotal(!showTotal);
            d3.select("#chart")
                .datum(currentData)
                .call(chart);
        };

        window.regenerateData = function() {
            currentData = generateSampleData();
            d3.select("#chart")
                .datum(currentData)
                .call(chart);
        };

        // Demonstrate TypeScript type safety (would be enforced at compile time)
        console.log('Chart configuration:', chart.config());
        console.log('TypeScript demo ready! ðŸŽ‰');
    </script>

    <!-- Temporary: Include JavaScript version for now -->
    <script src="../mintwaterfall-chart.js"></script>
</body>
</html>
