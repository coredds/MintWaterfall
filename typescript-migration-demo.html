<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript Migration Test</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .title {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .status-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            color: #333;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 8px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        .status-check {
            color: #4CAF50;
            font-weight: bold;
        }
        .status-progress {
            color: #FF9800;
            font-weight: bold;
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
        }
        .metric-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ðŸŒŠ MintWaterfall TypeScript Migration</h1>
            <p class="subtitle">Gradual Migration Progress Demonstration</p>
        </div>

        <div class="status-card">
            <h2>ðŸ“Š Migration Status</h2>
            <div class="status-item">
                <span>TypeScript Infrastructure Setup</span>
                <span class="status-check">âœ… COMPLETE</span>
            </div>
            <div class="status-item">
                <span>Core Chart Module (mintwaterfall-chart-core.ts)</span>
                <span class="status-check">âœ… COMPILED</span>
            </div>
            <div class="status-item">
                <span>Type Definitions Generated</span>
                <span class="status-check">âœ… WORKING</span>
            </div>
            <div class="status-item">
                <span>D3.js Integration</span>
                <span class="status-check">âœ… COMPATIBLE</span>
            </div>
            <div class="status-item">
                <span>Remaining Modules (14)</span>
                <span class="status-progress">ðŸ”„ PENDING</span>
            </div>
        </div>

        <div class="metrics">
            <div class="metric">
                <div class="metric-value">12%</div>
                <div class="metric-label">Overall Progress</div>
            </div>
            <div class="metric">
                <div class="metric-value">1/15</div>
                <div class="metric-label">Modules Converted</div>
            </div>
            <div class="metric">
                <div class="metric-value">~800</div>
                <div class="metric-label">Lines Converted</div>
            </div>
            <div class="metric">
                <div class="metric-value">0</div>
                <div class="metric-label">TS Compile Errors</div>
            </div>
        </div>

        <div class="chart-container">
            <h3>TypeScript Chart Demo</h3>
            <p>This chart is rendered using the TypeScript-compiled core module with full type safety.</p>
            
            <div class="controls">
                <button class="btn" onclick="toggleMode()">Toggle Stacked/Waterfall</button>
                <button class="btn" onclick="toggleTotal()">Toggle Total Bar</button>
                <button class="btn" onclick="newData()">Generate New Data</button>
                <button class="btn" onclick="showTypeInfo()">Show Type Info</button>
            </div>

            <div style="text-align: center;">
                <svg id="chart" width="800" height="400"></svg>
            </div>
        </div>

        <div class="status-card">
            <h2>ðŸš€ Next Steps</h2>
            <p><strong>Priority 1:</strong> Convert data processing module (mintwaterfall-data.ts)</p>
            <p><strong>Priority 2:</strong> Convert scales module (mintwaterfall-scales.ts)</p>
            <p><strong>Priority 3:</strong> Convert feature modules (tooltip, export, zoom, brush)</p>
            <p><strong>Timeline:</strong> Complete migration in 2-3 weeks with gradual approach</p>
        </div>
    </div>

    <script type="module">
        // Import the compiled TypeScript module
        import { waterfallChart } from './dist/mintwaterfall-chart-core.js';

        // Sample data for demonstration
        function generateData() {
            const categories = ['Q1 Revenue', 'Q2 Revenue', 'Q3 Revenue', 'Q4 Revenue', 'Expenses', 'Tax'];
            return categories.map((label, i) => ({
                label,
                stacks: [{
                    value: Math.random() * 150 - 30,
                    color: i < 4 ? '#2ecc71' : '#e74c3c'
                }]
            }));
        }

        // Create chart instance with TypeScript
        const chart = waterfallChart()
            .width(760)
            .height(360)
            .margin({top: 30, right: 50, bottom: 50, left: 60})
            .showTotal(true)
            .stacked(false);

        let currentData = generateData();
        
        // Initial render
        d3.select("#chart")
            .datum(currentData)
            .call(chart);

        // Demo functions
        window.toggleMode = function() {
            const isStacked = chart.stacked();
            chart.stacked(!isStacked);
            d3.select("#chart").datum(currentData).call(chart);
        };

        window.toggleTotal = function() {
            const showTotal = chart.showTotal();
            chart.showTotal(!showTotal);
            d3.select("#chart").datum(currentData).call(chart);
        };

        window.newData = function() {
            currentData = generateData();
            d3.select("#chart").datum(currentData).call(chart);
        };

        window.showTypeInfo = function() {
            const config = chart.config();
            alert(`TypeScript Configuration:
Width: ${config.width}
Height: ${config.height}
Show Total: ${config.showTotal}
Stacked: ${config.stacked}
Format Function: ${typeof config.formatNumber}`);
        };

        console.log('âœ… TypeScript migration demo loaded successfully!');
        console.log('ðŸ“Š Chart configuration:', chart.config());
    </script>
</body>
</html>
